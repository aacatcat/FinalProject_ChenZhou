##' @title R package demo for Forward Stepwise Selection (for test)
##' @author Chen Zhou
##' @export


test.f_model_select<-function(data){

  if(!requireNamespace("broom",quietly=TRUE))
    install.packages("broom")
  library(broom)

  if(!requireNamespace("testthat",quietly=TRUE))
    install.packages("testthat")
  library(testthat)

  x1<-c(11.46,6.82,14.3,4.4,17.94,11.5,9.88,17.04,4.08,16.64,4.8,9.66,15.04,9.34,5.62,11.34,16.6,19.22,18.52,15.98,2.18,9.92,11.8,16.56,11.68,6.24,17.2,
        18.9,7.5,8.24,11.32,6.08,14.22,7.16,17.16,8.98,6.26,17.56,4.48,19.28,7.32,10.3,14.78,9.4,4.48,10.18,17.06,17.28,17.64,13.58,2.04,6.4,13.44,15.6,
        11.18,7.62,16.34,16.1,4.78,10.6,13.38,8.76,14.78,6.88,18.82,9.86,6.02,17.2,5.12,17.08,4.44,9.24,13.42,8.44,5.66,12.86,16.18,16.08,18.56,12.46,
        0.22,6.9,10.42,15.18,10.62,6.56,15.52,19,4.24,8.9,11.16,6.18,13.12,7.28,16.04,10.66,6.52,17.18,5.44,19.98,6.28,9.92,12.68,10.06,2.74,10.26,16.12,
        16.28,19.5,15.66,3.36,6.18,13.78,16.34,8.36,8.82,17.88,19,7.54,8.94,12.5,9.48,15.32,4.18,18.36,9.32,7.94,16.84,5.12,18.84,5.06,8.32,12.88,9.18,
        4.04,10.44,15.8,18.94,19.46,15.4,2.82,7.9,12.68,17.6,11.34,7.94,14.14,18.68,5.76,8,11.32,7.62,12.12,5.64,19.24,9.56,7.54,15.2,6.38,18.64,6.36,
        11.74,15.16,11.98,5.72,12.98,17.92,18.38,17.26,12.58,0.58,6.6,13.26,16.42,8.34,7.5,16.44,16.82,5.6,9.46,16.28,19.08,14.16,2.22,8.78,10.22,16.64,
        9.48,7.06,18,17.64,7.2,11.06,11.04,16.6,11.1,7.8,14.04,17.28,4.8)
  x2<-c(42.53,11.77,33.6,10.73,46.2,32.9,29.07,40.27,18.07,44.27,13.27,26.13,39.47,22,7.27,30.03,46.7,52.27,50.23,35.9,17.1,29.6,37.7,26.23,33.57,13.73,
        28.6,47.1,30.87,15.33,38.9,11.37,34.83,14.07,49.8,33.6,34.23,45.3,20.73,44.53,13.57,26,38.4,18.93,5.1,31.73,43.27,48.33,48.53,40.13,15.8,29.07,39.57,
        28.1,30.5,10.37,22.9,43.37,33.5,24.07,36.4,19.87,37,16.9,48.43,37.77,28.9,44.2,21.6,38.93,18.2,26.83,39.67,20.5,2.3,38.17,41.3,48.4,49.83,42.13,15.9,
        25.83,32.7,31.57,34.23,8.2,28.9,49.7,26.47,18.87,43.87,12.47,38.9,11.07,46.4,36.23,34.57,44.43,22.97,41.53,11.57,27.7,38.97,19.07,4.3,36.07,45.43,
        53.83,46.9,37,18.33,32.4,38.07,30.4,36.97,6,29.6,40,25.67,21.37,39.23,10.07,36.37,18.6,51.13,30.77,35,43.43,22.87,35.67,10.23,27.47,38.27,19.33,3.8,
        31.6,40.7,45.93,50.53,39.17,11.23,31.93,32.87,29.17,38.6,6.37,24.33,45.07,27.93,22.3,42.5,13.53,39.4,13.5,54,35.13,27.63,44.67,21,37.63,18.5,33.4,
        33.8,24.47,0.97,32.8,40.3,51.3,45.7,41.77,12.8,28.9,30.07,26.7,38.23,9.67,20.4,42.27,25.87,24.5,52.97,53.77,42.4,13.23,27.97,34.87,30.67,34.13,7.17,
        23.77,44.67,29.17,21.27,37.47,25.1,35.97,14.77,24.27,41.5,30.17)
  x3<-c(7.25,4.01,8.86,2.09,6.4,5.86,5.59,8.55,1.14,4.81,2.13,5.35,6.54,4.19,0.01,5.03,6.05,8.59,8.74,4.34,3.71,5.6,5.24,6.96,6.5,3.01,4.24,6.73,5.83,4.03,
        7.56,3.23,8.18,3.18,7.55,4.69,5.36,9.73,1.06,4.96,2.5,5.59,6.41,4.06,0.76,4.18,6.2,7.7,9.83,5.83,3.1,4.23,6.15,5.69,5.2,3.74,4.25,5.38,5.06,4.79,
        8.26,4.93,7.26,2.96,6.96,5.81,5.71,9,2.8,5.85,1.08,4.39,6.64,3.51,1.13,4.14,6.1,7.21,8.26,4.31,2.6,5.96,5.93,5.75,5.35,3.34,5,6.38,5.31,4.93,7.16,
        3.3,8.14,3.69,7.15,4.39,5.2,8.04,1.41,4.19,1.73,4.21,5.13,4.6,1.33,4.8,6.53,7.19,9.69,4.69,2.73,5.94,6.3,6.94,6.78,3.68,5.43,5.84,5.23,3.01,7.13,
        3.79,8.84,2.03,7.11,5.61,4.46,8.94,2.49,5.31,1.48,5.6,6.45,3.49,0.13,5.29,6.45,8.16,8.66,4.75,3.14,4.28,6.61,5.9,5.95,2.85,5.94,5.05,5.13,3.39,
        8.28,4.79,7.61,3.03,6.65,4.74,4.01,8.66,1.54,4.86,2.9,5.36,6.45,3.88,1.89,5.9,7.18,8.63,9.59,4.54,3.44,4.96,5.33,6.89,5.51,2.81,4.6,5.95,6.94,4.98,
        8.03,9.58,4.75,2.46,4.2,5.09,5.89,6.56,3.94,5.66,6.06,5.65,3.23,5.88,6.28,6.38,3.03,4.13,5.18,5.16)
  x4<-c(40.35,34.18,33.45,24.95,39.63,38.24,33.39,23.51,18.05,43.66,27.41,30.97,34.29,34.76,35.72,29.54,26.03,33.47,41.4,29.99,27.05,20.67,34.85,41.25,38.48,
        25.01,27.07,40.1,25.83,33.79,37.69,21.27,38.41,18.85,27.55,26.79,21.33,35.25,22.86,40.91,30.45,32.21,29.75,34.39,26.96,31.23,34.45,27.61,24.33,40.71,
        30.8,26.7,22.36,29.27,28.77,28.96,37.92,40.83,32,24.62,25.19,20.61,24.91,22.75,38.56,33.99,24.92,33.71,27.73,35.02,32.61,23.11,27.92,29.67,34.19,23.82,
        38.7,26.2,28.38,30.4,27.65,29.62,24.34,29.37,28.11,32.61,36.74,43.33,19.84,30.06,31.23,28.06,26.82,31.06,38,37.28,31.17,26.56,34.81,43.71,21.6,31.61,
        25.86,32.01,36.54,25.42,27.83,26.24,36.87,26.67,25.33,32.35,25.9,38.59,30.09,33.63,33.22,30.72,34.71,39.65,36.01,20.58,32.26,22.31,29.68,34.1,27.72,
        38.07,37.15,30.79,31.24,27.85,36.89,22.67,31.54,34.24,40.12,32.61,43.71,30.9,16.94,33.81,38.59,36.98,23.5,27.03,41.72,41.37,32.31,36.21,38.15,34.28,
        22,23.28,30.75,38.6,28.36,34.01,29.3,35.57,19.76,38.05,36.32,30.55,32.81,28.7,38.04,39.18,38.29,25.01,29.25,28.95,31.28,32.77,37.48,23.42,29.94,25.16,
        34.7,23.14,35.36,40.56,38.51,31.9,31.32,23.95,41.96,26.15,29.82,34.42,41.69,27.92,22.92,23.63,25.97,33.07,26.54,39.06,32.79,20.66)
  y<-c(8.96,3.38,8.48,1.66,10.06,7.78,6.38,9.84,1.94,7,1.74,5.44,5.3,2.14,0.82,6.46,9.88,9.94,10.82,6.94,0.08,7.3,6.88,4.24,7.94,2.16,3.18,7.1,9.96,4.08,9.82,
       2.78,8.38,1.36,10.86,6.84,5.78,10.06,1.96,5.24,0.76,6.16,5.7,1.06,1.16,6.22,9.78,9.88,10.78,5.2,0.54,6.84,7.3,4.56,8.9,2.14,3.88,8.86,8.72,4.76,8.22,
       3.62,8.34,2.16,9.56,7.92,6.72,9.12,1.94,5,0.74,5.74,4.24,1.22,0.96,5.96,8.88,9.38,10.44,6.66,0.1,6.84,7.98,3.5,8.9,2.76,2.06,8.22,8.86,4.36,9.22,2.6,
       7.94,2.96,9.06,6.6,5.56,10.38,2.32,5.6,1.34,5.22,5.06,2.6,1.66,5.62,8.2,8.66,10.68,5.66,1.26,6.02,7.82,3.7,7.96,2.22,2.7,8.26,9,5.54,8.38,2.34,7.5,1.64,
       9.04,6.2,6.02,9.38,2.96,6.46,0.66,6.72,5.88,2.86,0.12,5.78,8.18,9.84,10.5,5.8,0.12,7.2,7.6,3.18,7.42,2.04,2.94,7.18,8.46,5.72,9.34,3.6,7.48,1.32,10.38,
       7.4,5.42,9.8,2.04,5.64,1.52,5.52,4,1.8,1.92,6.88,9.06,8.36,10.44,6.64,0.92,6.5,6.1,3.88,7.12,1.52,3.28,7.44,8.14,4.2,8.76,10.68,6.16,0.08,6.58,6.88,3.14,
       8.38,2.04,3.88,8.06,9.76,5.18,7.5,4.8,7.82,2.52,3.44,7.52,9.54)
  data<-data.frame(x1,x2,x3,x4,y)

  context("f_model_select:The validity of optimal model")
  library(testChenZhou)

  test_that("f_model_select is the validity of optimal model", {
    #data
    x1<-c(11.46,6.82,14.3,4.4,17.94,11.5,9.88,17.04,4.08,16.64,4.8,9.66,15.04,9.34,5.62,11.34,16.6,19.22,18.52,15.98,2.18,9.92,11.8,16.56,11.68,6.24,17.2,
          18.9,7.5,8.24,11.32,6.08,14.22,7.16,17.16,8.98,6.26,17.56,4.48,19.28,7.32,10.3,14.78,9.4,4.48,10.18,17.06,17.28,17.64,13.58,2.04,6.4,13.44,15.6,
          11.18,7.62,16.34,16.1,4.78,10.6,13.38,8.76,14.78,6.88,18.82,9.86,6.02,17.2,5.12,17.08,4.44,9.24,13.42,8.44,5.66,12.86,16.18,16.08,18.56,12.46,
          0.22,6.9,10.42,15.18,10.62,6.56,15.52,19,4.24,8.9,11.16,6.18,13.12,7.28,16.04,10.66,6.52,17.18,5.44,19.98,6.28,9.92,12.68,10.06,2.74,10.26,16.12,
          16.28,19.5,15.66,3.36,6.18,13.78,16.34,8.36,8.82,17.88,19,7.54,8.94,12.5,9.48,15.32,4.18,18.36,9.32,7.94,16.84,5.12,18.84,5.06,8.32,12.88,9.18,
          4.04,10.44,15.8,18.94,19.46,15.4,2.82,7.9,12.68,17.6,11.34,7.94,14.14,18.68,5.76,8,11.32,7.62,12.12,5.64,19.24,9.56,7.54,15.2,6.38,18.64,6.36,
          11.74,15.16,11.98,5.72,12.98,17.92,18.38,17.26,12.58,0.58,6.6,13.26,16.42,8.34,7.5,16.44,16.82,5.6,9.46,16.28,19.08,14.16,2.22,8.78,10.22,16.64,
          9.48,7.06,18,17.64,7.2,11.06,11.04,16.6,11.1,7.8,14.04,17.28,4.8)
    x2<-c(42.53,11.77,33.6,10.73,46.2,32.9,29.07,40.27,18.07,44.27,13.27,26.13,39.47,22,7.27,30.03,46.7,52.27,50.23,35.9,17.1,29.6,37.7,26.23,33.57,13.73,
          28.6,47.1,30.87,15.33,38.9,11.37,34.83,14.07,49.8,33.6,34.23,45.3,20.73,44.53,13.57,26,38.4,18.93,5.1,31.73,43.27,48.33,48.53,40.13,15.8,29.07,39.57,
          28.1,30.5,10.37,22.9,43.37,33.5,24.07,36.4,19.87,37,16.9,48.43,37.77,28.9,44.2,21.6,38.93,18.2,26.83,39.67,20.5,2.3,38.17,41.3,48.4,49.83,42.13,15.9,
          25.83,32.7,31.57,34.23,8.2,28.9,49.7,26.47,18.87,43.87,12.47,38.9,11.07,46.4,36.23,34.57,44.43,22.97,41.53,11.57,27.7,38.97,19.07,4.3,36.07,45.43,
          53.83,46.9,37,18.33,32.4,38.07,30.4,36.97,6,29.6,40,25.67,21.37,39.23,10.07,36.37,18.6,51.13,30.77,35,43.43,22.87,35.67,10.23,27.47,38.27,19.33,3.8,
          31.6,40.7,45.93,50.53,39.17,11.23,31.93,32.87,29.17,38.6,6.37,24.33,45.07,27.93,22.3,42.5,13.53,39.4,13.5,54,35.13,27.63,44.67,21,37.63,18.5,33.4,
          33.8,24.47,0.97,32.8,40.3,51.3,45.7,41.77,12.8,28.9,30.07,26.7,38.23,9.67,20.4,42.27,25.87,24.5,52.97,53.77,42.4,13.23,27.97,34.87,30.67,34.13,7.17,
          23.77,44.67,29.17,21.27,37.47,25.1,35.97,14.77,24.27,41.5,30.17)
    x3<-c(7.25,4.01,8.86,2.09,6.4,5.86,5.59,8.55,1.14,4.81,2.13,5.35,6.54,4.19,0.01,5.03,6.05,8.59,8.74,4.34,3.71,5.6,5.24,6.96,6.5,3.01,4.24,6.73,5.83,4.03,
          7.56,3.23,8.18,3.18,7.55,4.69,5.36,9.73,1.06,4.96,2.5,5.59,6.41,4.06,0.76,4.18,6.2,7.7,9.83,5.83,3.1,4.23,6.15,5.69,5.2,3.74,4.25,5.38,5.06,4.79,
          8.26,4.93,7.26,2.96,6.96,5.81,5.71,9,2.8,5.85,1.08,4.39,6.64,3.51,1.13,4.14,6.1,7.21,8.26,4.31,2.6,5.96,5.93,5.75,5.35,3.34,5,6.38,5.31,4.93,7.16,
          3.3,8.14,3.69,7.15,4.39,5.2,8.04,1.41,4.19,1.73,4.21,5.13,4.6,1.33,4.8,6.53,7.19,9.69,4.69,2.73,5.94,6.3,6.94,6.78,3.68,5.43,5.84,5.23,3.01,7.13,
          3.79,8.84,2.03,7.11,5.61,4.46,8.94,2.49,5.31,1.48,5.6,6.45,3.49,0.13,5.29,6.45,8.16,8.66,4.75,3.14,4.28,6.61,5.9,5.95,2.85,5.94,5.05,5.13,3.39,
          8.28,4.79,7.61,3.03,6.65,4.74,4.01,8.66,1.54,4.86,2.9,5.36,6.45,3.88,1.89,5.9,7.18,8.63,9.59,4.54,3.44,4.96,5.33,6.89,5.51,2.81,4.6,5.95,6.94,4.98,
          8.03,9.58,4.75,2.46,4.2,5.09,5.89,6.56,3.94,5.66,6.06,5.65,3.23,5.88,6.28,6.38,3.03,4.13,5.18,5.16)
    x4<-c(40.35,34.18,33.45,24.95,39.63,38.24,33.39,23.51,18.05,43.66,27.41,30.97,34.29,34.76,35.72,29.54,26.03,33.47,41.4,29.99,27.05,20.67,34.85,41.25,38.48,
          25.01,27.07,40.1,25.83,33.79,37.69,21.27,38.41,18.85,27.55,26.79,21.33,35.25,22.86,40.91,30.45,32.21,29.75,34.39,26.96,31.23,34.45,27.61,24.33,40.71,
          30.8,26.7,22.36,29.27,28.77,28.96,37.92,40.83,32,24.62,25.19,20.61,24.91,22.75,38.56,33.99,24.92,33.71,27.73,35.02,32.61,23.11,27.92,29.67,34.19,23.82,
          38.7,26.2,28.38,30.4,27.65,29.62,24.34,29.37,28.11,32.61,36.74,43.33,19.84,30.06,31.23,28.06,26.82,31.06,38,37.28,31.17,26.56,34.81,43.71,21.6,31.61,
          25.86,32.01,36.54,25.42,27.83,26.24,36.87,26.67,25.33,32.35,25.9,38.59,30.09,33.63,33.22,30.72,34.71,39.65,36.01,20.58,32.26,22.31,29.68,34.1,27.72,
          38.07,37.15,30.79,31.24,27.85,36.89,22.67,31.54,34.24,40.12,32.61,43.71,30.9,16.94,33.81,38.59,36.98,23.5,27.03,41.72,41.37,32.31,36.21,38.15,34.28,
          22,23.28,30.75,38.6,28.36,34.01,29.3,35.57,19.76,38.05,36.32,30.55,32.81,28.7,38.04,39.18,38.29,25.01,29.25,28.95,31.28,32.77,37.48,23.42,29.94,25.16,
          34.7,23.14,35.36,40.56,38.51,31.9,31.32,23.95,41.96,26.15,29.82,34.42,41.69,27.92,22.92,23.63,25.97,33.07,26.54,39.06,32.79,20.66)
    y<-c(8.96,3.38,8.48,1.66,10.06,7.78,6.38,9.84,1.94,7,1.74,5.44,5.3,2.14,0.82,6.46,9.88,9.94,10.82,6.94,0.08,7.3,6.88,4.24,7.94,2.16,3.18,7.1,9.96,4.08,9.82,
         2.78,8.38,1.36,10.86,6.84,5.78,10.06,1.96,5.24,0.76,6.16,5.7,1.06,1.16,6.22,9.78,9.88,10.78,5.2,0.54,6.84,7.3,4.56,8.9,2.14,3.88,8.86,8.72,4.76,8.22,
         3.62,8.34,2.16,9.56,7.92,6.72,9.12,1.94,5,0.74,5.74,4.24,1.22,0.96,5.96,8.88,9.38,10.44,6.66,0.1,6.84,7.98,3.5,8.9,2.76,2.06,8.22,8.86,4.36,9.22,2.6,
         7.94,2.96,9.06,6.6,5.56,10.38,2.32,5.6,1.34,5.22,5.06,2.6,1.66,5.62,8.2,8.66,10.68,5.66,1.26,6.02,7.82,3.7,7.96,2.22,2.7,8.26,9,5.54,8.38,2.34,7.5,1.64,
         9.04,6.2,6.02,9.38,2.96,6.46,0.66,6.72,5.88,2.86,0.12,5.78,8.18,9.84,10.5,5.8,0.12,7.2,7.6,3.18,7.42,2.04,2.94,7.18,8.46,5.72,9.34,3.6,7.48,1.32,10.38,
         7.4,5.42,9.8,2.04,5.64,1.52,5.52,4,1.8,1.92,6.88,9.06,8.36,10.44,6.64,0.92,6.5,6.1,3.88,7.12,1.52,3.28,7.44,8.14,4.2,8.76,10.68,6.16,0.08,6.58,6.88,3.14,
         8.38,2.04,3.88,8.06,9.76,5.18,7.5,4.8,7.82,2.52,3.44,7.52,9.54)
    data<-data.frame(x1,x2,x3,x4,y)
    expect_that(f_model_select(data),equals("valid"))
  })
}
